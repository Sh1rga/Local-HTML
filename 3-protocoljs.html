<script>
var address_api = null;
function getParam(name, url) {if (!url) url = window.location.href;name = name.replace(/[\[\]]/g, "\\$&");var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),results = regex.exec(url);if (!results) return null;if (!results[2]) return '';return decodeURIComponent(results[2].replace(/\+/g, " "));}
const url = new URL(window.location.href);
function UseHTTPS(){
if (getParam('lang') == null) {
history.replaceState('','','?protocol=' + "https");
}else{
history.replaceState('','','?lang=' + getParam('lang') + '&protocol=' + "https");}
location.reload();}
function UseTor(){
if (getParam('lang') == null) {
history.replaceState('','','?protocol=' + "tor");
}else{
history.replaceState('','','?lang=' + getParam('lang') + '&protocol=' + "tor");}
location.reload();}
function UseHTTP(){
if (getParam('lang') == null) {
history.replaceState('','','?protocol=' + "http");
}else{
history.replaceState('','','?lang=' + getParam('lang') + '&protocol=' + "http");}
location.reload();}

function CSConnect(){
if (getParam('lang') == null) {
history.replaceState('','','?customserver=' + document.getElementById("csaddress").value);
}else{
history.replaceState('','','?lang=' + getParam('lang') + '&customserver=' + document.getElementById("csaddress").value);}
location.reload();}

function ViewConnectionSetting(){
history.replaceState('','','?');
location.reload();
}

if (getParam('customserver') == null) {
  if (getParam('protocol') == "http") {
	address_api = "http://chat.api-sh1r.ga";
	document.getElementById('box').innerHTML = "<br>Having connection problems?<br><button onClick=\"ViewConnectionSetting();return false;\">Connection Setting</button>";
  }else if (getParam('protocol') == "tor") {
	address_api = "http://chat.api-sh1rga.tsg4o4zjaknpkbefs2k47a7emkl54moz2t2k4py4gbyhz6v7vubsjbad.onion";
	document.getElementById('box').innerHTML = "<br>Having connection problems?<br><button onClick=\"ViewConnectionSetting();return false;\">Connection Setting</button>";
  }else if (getParam('protocol') == "https") {
	address_api = "https://chat.api-sh1r.ga";
	document.getElementById('box').innerHTML = "<br>Having connection problems?<br><button onClick=\"ViewConnectionSetting();return false;\">Connection Setting</button>";
  }else{
	document.getElementById('box').innerHTML = '<br><div class="setbox"><br><strong>Select the communication protocol.</strong><br><br><button onclick="UseHTTPS();">Use HTTPS</button><br><br><button onclick="UseTor();">Use Tor</button><br><br><button onclick="UseHTTP();">Use HTTP (deprecated)</button><br><br></div><br>OR<br><br><strong>Custom Server</strong><br><input type="url" id="csaddress"  alt="Enter the custom server address" enterkeyhint="done" aria-label="Enter the custom server address" style="width:360px;border-radius:32px" dir="ltr"><br><button onClick="CSConnect();return false;" style="border-radius:0 0 16px 16px;margin-top:-7px">Connect</button>';
  }
}else{
  address_api = getParam('customserver');
  document.getElementById('box').innerHTML = "<br>Having connection problems?<br><button onClick=\"ViewConnectionSetting();return false;\">Connection Setting</button>";
}
var address_client = "https://chat.sh1r.ga";
var address_web = "https://sh1r.ga";
</script>